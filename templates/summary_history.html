<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Weekly Analysis History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        /* Background and Font */
        body {
            background: #724520;   /* Earthy base */
            font-family: 'Quicksand', sans-serif;
            padding: 2rem;
            color: #822E2E; /* Deep reddish tone */
        }

        /* Main Container */
        .dashboard-container {
            background: #D5C4BA; /* Light parchment feel */
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Buttons */
        .btn-custom {
            background-color: #8B5E3C; /* Rich chestnut brown */
            color: white;
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 8px;
        }

        .btn-custom:hover {
            background-color: #A66A4C;
        }

        .btn-outline-primary {
             color: #822E2E;
            border-color: #822E2E;
        }

        .btn-outline-primary:hover {
            background-color: #822E2E;
            color: white;
        }

          /* Table Styling */
          .table th {
            background-color: #eae2d6;
            color: #9C7B61;
          }

          .table tbody tr {
            background-color: #fff9f0; /* Soft tan */
            transition: background-color 0.3s ease;
          }

        .table-hover tbody tr:hover {
            background-color: #f5ede3;
            transition: background-color 0.3s ease;
        }

        .section-title {
            font-weight: bold;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #2f2f2f;
        }

        /* Garden Image */
        .img-fluid {
            max-height: 180px;
            margin-bottom: 1rem;
            transition: transform 0.3 ease;
        }

        .img-fluid:hover {
            transform: scale(1.05);
        }

        /* Headings and Section Titles */
        .section-title;
        h4,
        h5 {
            color: #822E2E;
            font-weight:bold;
        }

        /* Table borders and cells */
        .table th,
        .table td {
            vertical-align: middle;
            border-color: #e0cfc1;
        }

        .progress-bar {
            font-weight: bold;
            font-size: 0.95rem;
            text-align: center;
        }

    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Greeting and action buttons -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold" style="color:#3E210E;">Welcome backüëã</h2>
             <div>
                 <a href="{{ url_for('dashboard') }}" class="btn btn-custom me-2"> Dashboard</a>
                 <a href="{{ url_for('analysis') }}" class="btn btn-custom"> üìä Analysis</a>
             </div>
        </div>


        <!-- Hustle Log Table Section -->
        <h5 class="section-title">üìö Your Weekly Summary History</h5>

        {% if summaries %}
            <div class="table-responsive">
                <table class="table table-bordered table-hover align-middle text-center">
                    <thead class="text-uppercase small">
                        <tr>
                            <th>S.Week</th>
                            <th>E.Week</th>
                            <th>Total Hours</th>
                            <th>Session Count</th>
                            <th>Productivity Score</th>
                            <th>Burn Out Flag</th>
                            <th>Excuse Count</th>
                            <th>AI Feedback</th>
                            <th>Goal (Hrs)</th>
                            <th>Achieved?</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for summary in summaries %}
                            <tr>
                                <td>{{ summary.week_start.strftime('%b %d, %Y') }}</td>
                                <td>{{ summary.week_end.strftime('%b %d, %Y') }}</td>
                                <td>{{ summary.total_hours }}</td>
                                <td>{{ summary.session_count }}</td>
                                <td>
                                    {% if summary.productivity_score is not none %}
                                        {{ summary.productivity_score }}
                                        {% if summary.productivity_score >= 90 %}
                                            <span class="badge bg-success ms-2"> üåü Excellent</span>
                                        {% elif summary.productivity_score >= 75 %}
                                             <span class="badge bg-primary ms-2"> ‚úÖ Healthy</span>
                                        {% elif summary.productivity_score >= 60 %}
                                              <span class="badge bg-warning text-dark ms-2"> ‚ö†Ô∏è Needs Attention</span>
                                        {% elif summary.productivity_score >= 40 %}
                                              <span class="badge bg-danger ms-2"> üö® At Risk</span>
                                        % else %}
                                               <span class="badge bg-dark ms-2">üîªCritical </span>
                                        {% endif %}
                                    {% else %}
                                        <span class="text-muted">N/A</span>
                                    {% endif %}
                                </td>
                                <td>{{ summary.burnout_flag }}</td>
                                <td>{{ summary.excuse_count }}</td>
                                <td style="max-width: 250px; overflow-wrap: break-word;">{{ summary.ai_feedback  }}</td>
                                <td>{{ summary.goal_target or "_" }}</td>
                                <td>
                                    {% if summary.goal_target is not none %}
                                        {% if summary.goal_achieved %}
                                            <span class="badge bg-success">YES</span>
                                        {% else %}
                                            <span class="badge bg-danger">NO</span>
                                        {% endif %}
                                    {% else %}
                                        <span class="text-muted">‚Äî</span>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p class="text-muted">No Records Yet. </p>
        {% endif %}
    </div>
</body>
</html>